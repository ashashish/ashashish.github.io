<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans" rel="stylesheet">
    <title>Landing page with Surfly PIN</title>

    <style type='text/css'>
        html, body {
            min-height: 100vh;
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            font-family: "Open Sans", sans-serif;
            display: flex;
            flex-direction: row;
        }

        .left-half, .right-half {
            width: 50%;
        }

        .left-half {
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image {
            height: 100%;
            width: 100%;
            object-fit: contain;
        }

        .right-half {
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        h1 {
            font-size: 1.5em;
            text-align: center;
        }

        .tandc-box {
            height: 250px;
            overflow-y: scroll;
            padding: 10px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
            font-size: 0.9em;
        }

        .code-box {
            text-align: center;
            margin-top: 20px;
            font-size: 1.2em;
            padding: 10px;
            border: 1px solid #4CAF50;
            background-color: #4CAF50;
            color: white;
            display: none; /* Initially hidden */
        }

        .waiting-message {
            text-align: center;
            margin-top: 10px;
            font-size: 1em;
            color: #888;
            display: none; /* Initially hidden */
        }

        /* Media Query for Mobile */
        @media (max-width: 768px) {
            html, body {
                flex-direction: column;
            }

            .left-half, .right-half {
                width: 100%;
            }

            .right-half {
                padding: 15px;
            }

            h1 {
                font-size: 1.2em;
            }

            .tandc-box {
                height: 200px;
                font-size: 0.85em;
            }

            .code-box {
                font-size: 1em;
            }

            .waiting-message {
                font-size: 0.9em;
            }
        }

        .accept-button {
            margin-top: 10px;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            width: 100%;
            text-align: center;
        }

        .accept-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>

<body>
    <div class="left-half">
        <img src="https://driven.fleet-account.com/img/brands/mini/driven.d37c7494ec92ded6d66d461d09fc532e316f4dc1e30901686fc9cdba498823ce.svg" alt="Image Placeholder" class="image">
    </div>

    <div class="right-half">
        <h1>BY SHARING THE 4-DIGIT PINCODE BELOW WITH THE AGENT, YOU ACKNOWLEDGE THAT YOU HAVE READ, UNDERSTAND, AND AGREE TO THESE TERMS AND CONDITIONS</h1>

        <div class="tandc-box">
            <p>Co-Browsing Session Terms and Conditions...</p>
            <!-- Insert new terms and conditions text here -->
            Co-Browsing Session Terms and Conditions ... (insert your terms here)
        </div>

        <label>
            <input type="checkbox" id="termsCheckbox"> I accept the above Terms and Conditions.
        </label>
        
        <button class="accept-button" id="acceptButton" disabled>Proceed</button>

        <div class="code-box" id="codeBox">
            Your PINCODE: <b><span id="sessidtarget">...</span></b>
        </div>

        <div class="waiting-message" id="waitingMessage">
            Waiting for Agent to join!
        </div>
    </div>

    <script>
        // Enable button only when checkbox is checked
        document.getElementById('termsCheckbox').addEventListener('change', function() {
            document.getElementById('acceptButton').disabled = !this.checked;
        });

        // Surfly snippet
        (function(s,u,r,f,l,y){s[f]=s[f]||{init:function(){s[f].q=arguments}};
        l=u.createElement(r);y=u.getElementsByTagName(r)[0];l.async=1;
        l.src='https://surfly.com/surfly.js';y.parentNode.insertBefore(l,y);})
        (window,document,'script','Surfly');

        // Surfly settings
        var settings = {
            widget_key: "9eb008187dca447685c55d80614e1d18", 
            hide_until_agent_joins: true,
            url: "https://driven.fleet-account.com/"
        };

        // Handle button click
        document.getElementById('acceptButton').addEventListener('click', function() {
            // Hide the button after click
            document.getElementById('acceptButton').style.display = 'none';

            // Initialize Surfly and handle session creation
            Surfly.init(settings, function(init) {
                if (init.success && !Surfly.isInsideSession) {
                    Surfly.session()
                    .on("session_created", function(session, event) {
                        // Display the PIN of the current session
                        document.querySelector("#sessidtarget").innerText = session.pin;
                        // Show the PIN and waiting message
                        document.getElementById('codeBox').style.display = 'block';
                        document.getElementById('waitingMessage').style.display = 'block';
                    })
                    .startLeader();
                } else {
                    console.error("Surfly initialization failed or session is already active.");
                }
            });
        });
    </script>
</body>

</html>
