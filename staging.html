<!DOCTYPE html>
<html>
<head>
	<title>Co-Booking</title>
</head>
<body>
	<h1>Welcome to Demo Replica of Airbnb Website</h1>
	<br>
	<p>Book rooms together with your friends in real-time.</p>

	<!-- Start Session -->
	<h2>Start a Co-Booking Session</h2>
	<p>Click the "Co-Booking" button below to start a co-booking session:</p>
	<button id="startSessionButton">Co-Booking</button>
	<br><br>
	<p id="startSessionInfo" style="display: none"><b>Co-Booking Code: </b><span id="startSessionCode"></span></p>

	<!-- Join Session -->
<!-- Join Session -->
<h2>Join a Co-Booking Session</h2>
<p>Enter the co-booking code below and click "Join" to join a co-booking session:</p>
<form id="joinSessionForm">
    <input type="text" id="joinSessionCodeInput" placeholder="Co-Booking Code" required>
    <button type="submit">Join</button>
</form>
<p id="joinErrorMessage" style="display: none; color: red;">Incorrect co-booking code. Please try again.</p>

<script>
    // Join Session
    document.querySelector('#joinSessionForm').addEventListener('submit', function(event) {
        event.preventDefault();
        joinSession();
    });

    function joinSession() {
        var joinCode = document.querySelector('#joinSessionCodeInput').value;

        // Call the .session method to join the Surfly session
        Surfly.session()
            .on("session_joined", function(session, event) {
                // Redirect to the co-booking session URL
                window.location.href = session.url;
            })
            .on("session_join_error", function(session, event) {
                document.querySelector('#joinErrorMessage').style.display = 'block';
            })
            .follower()
            .join(joinCode);
    }
</script>

	<script>
		(function(s, u, r, f, l, y) {
			s[f] = s[f] || { init: function() { s[f].q = arguments; } };
			l = u.createElement(r);
			y = u.getElementsByTagName(r)[0];
			l.async = 1;
			l.src = 'https://surfly.com/surfly.js';
			y.parentNode.insertBefore(l, y);
		})(window, document, 'script', 'Surfly');

		var settings = {
			// Surfly session options can be set here, or at the Company/Plan levels.
			widget_key: '9eb008187dca447685c55d80614e1d18',
			hide_until_agent_joins: true,
			session_start_confirmation: false,
			url: "https://www.airbnb.com"
		};

		Surfly.init(settings, function(initResult) {
			if (initResult.success) {
				// API calls can now be made!
			} else {
				console.log("Surfly was unable to initialize properly.");
			}
		});
	</script>
</body>
</html>
